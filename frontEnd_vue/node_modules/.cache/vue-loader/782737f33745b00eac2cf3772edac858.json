{"remainingRequest":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\src\\components\\student\\myNotice.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\src\\components\\student\\myNotice.vue","mtime":1649513092785},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637570406894},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\babel-loader\\lib\\index.js","mtime":1627202897183},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637570406894},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\vue-loader\\lib\\index.js","mtime":1648636261085}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBnZXROb3RpY2VSZXF1ZXN0LA0KICBnZXROb3RpY2VSZWFkUmVxdWVzdCwNCiAgZ29VbnJlYWRSZXF1ZXN0LA0KICBnb3lpZHVSZXF1ZXN0LA0KfSBmcm9tICJAL2FwaS9yZXF1ZXN0IjsNCmltcG9ydCB7IGZvcm1hdFRpbWUgfSBmcm9tICdAL2FwaS91dGlscyc7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG5vdGljZU51bTogMCwgLy/pgJrnn6XmgLvmlbANCiAgICAgIGFsbE5vdGljZURhdGE6IFtdLCAvL+iOt+WPlueahOaJgOaciemAmuefpQ0KICAgICAgY3VycmVudFBhZ2U6IDEsDQogICAgICBwYWdlU2l6ZTogNSwNCiAgICAgIHBhZ2VObzogMSwNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZ2V0QWxsTm90aWNlKHRoaXMucGFnZVNpemUsIHRoaXMucGFnZU5vKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8qKg0KICAgICAqIOaIkeeahOmAmuefpeWIhumhteiOt+WPluaVsOaNruS4juaVsOmHjw0KICAgICAqICovDQogICAgZ2V0QWxsTm90aWNlKHBhZ2VOdW0sIGN1cnJQYWdlKSB7DQogICAgICBnZXROb3RpY2VSZXF1ZXN0KHsgcGFnZU51bTogcGFnZU51bSwgY3VyclBhZ2U6IGN1cnJQYWdlIC0gMSB9KQ0KICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgdGhpcy5ub3RpY2VOdW0gPSByZXMudG90YWw7DQogICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaCgodikgPT4gew0KICAgICAgICAgICAgdi5yZWFkVHlwZSA9ICLmnKror7siOw0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMuYWxsTm90aWNlRGF0YSA9IHJlcy5kYXRhLm1hcChpdGVtID0+IHsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgIC4uLml0ZW0sDQogICAgICAgICAgICAgIGNyZWF0ZXRpbWU6IGZvcm1hdFRpbWUoaXRlbS5jcmVhdGV0aW1lKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMuZ2V0UmVhZCgpOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDojrflj5bnmoTmiJHpgJrnn6Xlt7Lor7vliJfooago5L6b5bey6K+75pyq6K+754q25oCB5riy5p+TKQ0KICAgICAqLw0KICAgIGdldFJlYWQoKSB7DQogICAgICBnZXROb3RpY2VSZWFkUmVxdWVzdCgpDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICByZXMuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICAgICAgbGV0IHZhbCA9IGl0ZW0ubl9pZDsNCiAgICAgICAgICAgIHRoaXMuYWxsTm90aWNlRGF0YS5mb3JFYWNoKCh2YWx1ZSkgPT4gew0KICAgICAgICAgICAgICBpZiAodmFsID09PSB2YWx1ZS5uX2lkKSB7DQogICAgICAgICAgICAgICAgdmFsdWUucmVhZFR5cGUgPSAi5bey6K+7IjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOW3suivu+S4juacquivu+i9rOaNog0KICAgICAqIEBwYXJhbSBpbmRleA0KICAgICAqIEBwYXJhbSByb3cNCiAgICAgKi8NCiAgICByZWFkTihfLCByb3cpIHsNCiAgICAgIGdvd2VpZHVSZXF1ZXN0KHsgbl9pZDogcm93Lm5faWQgfSkNCiAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5bey5L+u5pS55Li65pyq6K+7Iik7DQogICAgICAgICAgdGhpcy5nZXRBbGxOb3RpY2UodGhpcy5wYWdlU2l6ZSwgdGhpcy5wYWdlTm8pOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7DQogICAgfSwNCiAgICByZWFkWShfLCByb3cpIHsNCiAgICAgIGdveWlkdVJlcXVlc3QoeyBuX2lkOnJvdy5uX2lkIH0pDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICB0aGlzLmdldFJlYWQoKTsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuW3suS/ruaUueS4uuW3suivuyIpOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7DQogICAgfSwNCg0KICAgIC8v5YiG6aG1DQogICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpIHsNCiAgICAgIHRoaXMucGFnZVNpemUgPSB2YWw7DQogICAgICB0aGlzLmdldEFsbE5vdGljZSh0aGlzLnBhZ2VTaXplLCB0aGlzLnBhZ2VObyk7DQogICAgfSwNCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgew0KICAgICAgdGhpcy5wYWdlTm8gPSB2YWw7DQogICAgICB0aGlzLmdldEFsbE5vdGljZSh0aGlzLnBhZ2VTaXplLCB0aGlzLnBhZ2VObyk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["myNotice.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"myNotice.vue","sourceRoot":"src/components/student","sourcesContent":["<template>\r\n  <div>\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <el-card>\r\n          <div slot=\"header\" class=\"clearfix\" style=\"text-align: center\">\r\n            <span>我的通知</span>\r\n          </div>\r\n\r\n          <el-table\r\n            :data=\"allNoticeData\"\r\n            border\r\n            :default-sort=\"{ prop: 'date', order: 'descending' }\"\r\n            style=\"width: 100%\"\r\n          >\r\n            <el-table-column prop=\"createtime\" label=\"发布时间\"></el-table-column>\r\n            <el-table-column prop=\"title\" label=\"主题\"></el-table-column>\r\n            <el-table-column prop=\"content\" label=\"内容\"></el-table-column>\r\n            <el-table-column prop=\"readType\" label=\"状态\"></el-table-column>\r\n            <el-table-column label=\"操作\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button\r\n                  style=\"padding: 3px 0\"\r\n                  type=\"text\"\r\n                  @click=\"readN(scope.$index, scope.row)\"\r\n                >\r\n                  未读\r\n                </el-button>\r\n                <el-button\r\n                  style=\"padding: 3px 0\"\r\n                  type=\"text\"\r\n                  @click=\"readY(scope.$index, scope.row)\"\r\n                >\r\n                  已读\r\n                </el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n\r\n          <div class=\"block\" style=\"text-align: center; margin-top: 20px\">\r\n            <el-pagination\r\n              @size-change=\"handleSizeChange\"\r\n              @current-change=\"handleCurrentChange\"\r\n              :current-page=\"currentPage\"\r\n              :page-sizes=\"[5, 10, 15, 20, 25]\"\r\n              :page-size=\"5\"\r\n              layout=\"total, sizes, prev, pager, next, jumper\"\r\n              :total=\"noticeNum\"\r\n            >\r\n            </el-pagination>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getNoticeRequest,\r\n  getNoticeReadRequest,\r\n  goUnreadRequest,\r\n  goyiduRequest,\r\n} from \"@/api/request\";\r\nimport { formatTime } from '@/api/utils';\r\nexport default {\r\n  data() {\r\n    return {\r\n      noticeNum: 0, //通知总数\r\n      allNoticeData: [], //获取的所有通知\r\n      currentPage: 1,\r\n      pageSize: 5,\r\n      pageNo: 1,\r\n    };\r\n  },\r\n  created() {\r\n    this.getAllNotice(this.pageSize, this.pageNo);\r\n  },\r\n  methods: {\r\n    /**\r\n     * 我的通知分页获取数据与数量\r\n     * */\r\n    getAllNotice(pageNum, currPage) {\r\n      getNoticeRequest({ pageNum: pageNum, currPage: currPage - 1 })\r\n        .then((res) => {\r\n          this.noticeNum = res.total;\r\n          res.data.forEach((v) => {\r\n            v.readType = \"未读\";\r\n          });\r\n          this.allNoticeData = res.data.map(item => {\r\n            return {\r\n              ...item,\r\n              createtime: formatTime(item.createtime)\r\n            }\r\n          });\r\n          this.getRead();\r\n        })\r\n        .catch((err) => console.log(err));\r\n    },\r\n    /**\r\n     * 获取的我通知已读列表(供已读未读状态渲染)\r\n     */\r\n    getRead() {\r\n      getNoticeReadRequest()\r\n        .then((res) => {\r\n          res.forEach((item) => {\r\n            let val = item.n_id;\r\n            this.allNoticeData.forEach((value) => {\r\n              if (val === value.n_id) {\r\n                value.readType = \"已读\";\r\n              }\r\n            });\r\n          });\r\n        })\r\n        .catch((err) => console.log(err));\r\n    },\r\n    /**\r\n     * 已读与未读转换\r\n     * @param index\r\n     * @param row\r\n     */\r\n    readN(_, row) {\r\n      goweiduRequest({ n_id: row.n_id })\r\n        .then((res) => {\r\n          this.$message.success(\"已修改为未读\");\r\n          this.getAllNotice(this.pageSize, this.pageNo);\r\n        })\r\n        .catch((err) => console.log(err));\r\n    },\r\n    readY(_, row) {\r\n      goyiduRequest({ n_id:row.n_id })\r\n        .then((res) => {\r\n          this.getRead();\r\n          this.$message.success(\"已修改为已读\");\r\n        })\r\n        .catch((err) => console.log(err));\r\n    },\r\n\r\n    //分页\r\n    handleSizeChange(val) {\r\n      this.pageSize = val;\r\n      this.getAllNotice(this.pageSize, this.pageNo);\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.pageNo = val;\r\n      this.getAllNotice(this.pageSize, this.pageNo);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"]}]}