{"remainingRequest":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\src\\components\\student\\volunteer.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\src\\components\\student\\volunteer.vue","mtime":1649515988844},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637570406894},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\babel-loader\\lib\\index.js","mtime":1627202897183},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637570406894},{"path":"C:\\Users\\冯潇洒\\Desktop\\Campus-epidemic-prevention-and-control-syste\\V2.0_Prevention\\vue_epidemic\\node_modules\\vue-loader\\lib\\index.js","mtime":1648636261085}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBnZXRVc2VyRGF0YUJ5VG9rZW4sDQogIGdldEhlYWx0aE5vd0RheUJ5aWRSZXF1ZXN0LA0KICBnZXRFbnRlclZvbHVudGVlclJlcXVzZXQsDQogIGdldEFsbFZvbHVudGVlclJlcXVlc3QsDQogIGdldFZvbHVudGVlckJ5SWRSZXF1ZXN0LA0KfSBmcm9tICJAL2FwaS9yZXF1ZXN0IjsNCmltcG9ydCB7IGZvcm1hdElELCBmb3JtYXRZZWFyIH0gZnJvbSAnQC9hcGkvdXRpbHMnOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAidm9sdW50ZWVyIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdXNlckluZm86ICIiLCAvL+eUqOaIt+S4quS6uuS/oeaBrw0KICAgICAgdm9sdW50ZWVyTGlzdDogW10sIC8v5omA5pyJ5b+X5oS/6ICF5YiX6KGoDQogICAgICBpc1ZvbHVuOiBmYWxzZSwNCiAgICAgIHVzZXJWb2x1bjogW10sDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBnZXRVc2VyRGF0YUJ5VG9rZW4oKS50aGVuKChyZXMpID0+IHsNCiAgICAgIHRoaXMudXNlckluZm8gPSByZXMNCiAgICB9KTsNCiAgICBnZXRBbGxWb2x1bnRlZXJSZXF1ZXN0KCkudGhlbigocmVzKSA9PiB7DQogICAgICByZXMuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICBpZiAodGhpcy51c2VySW5mby5pZCA9PT0gaXRlbS51X2lkKSB7DQogICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5pc1ZvbHVuID0gdHJ1ZTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICB0aGlzLnZvbHVudGVlckxpc3QgPSByZXMubWFwKChpdGVtKSA9PiB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgLi4uaXRlbSwNCiAgICAgICAgICBjcmVhdGV0aW1lOiBmb3JtYXRZZWFyKGl0ZW0uY3JlYXRldGltZSksDQogICAgICAgICAgdV9pZDpmb3JtYXRJRChpdGVtLnVfaWQpDQogICAgICAgIH07DQogICAgICB9KTsNCiAgICB9KTsNCiAgICBnZXRWb2x1bnRlZXJCeUlkUmVxdWVzdCgpLnRoZW4oKHJlcykgPT4gew0KICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgIHRoaXMudXNlclZvbHVuID0gcmVzLm1hcCgoaXRlbSkgPT4gew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgIC4uLml0ZW0sDQogICAgICAgICAgY3JlYXRldGltZTogaXRlbS5jcmVhdGV0aW1lLnNsaWNlKDAsIDEwKSwNCiAgICAgICAgICB1X2lkOg0KICAgICAgICAgICAgU3RyaW5nKGl0ZW0udV9pZClbMF0gPT09IDEgPyBTdHJpbmcoaXRlbS51X2lkKSA6IGAwJHtpdGVtLnVfaWR9YCwNCiAgICAgICAgfTsNCiAgICAgIH0pOw0KICAgIH0pOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy/miqXlkI3lv5fmhL/ogIUNCiAgICBlbnRlclZvbHVuKCkgew0KICAgICAgZ2V0SGVhbHRoTm93RGF5QnlpZFJlcXVlc3QoKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgaWYgKCFyZXMubGVuZ3RoKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCLkvaDku4rlpKnov5jmnKrlrozmiJDlgaXlurfloavmiqXvvIzor7flhYjlrozmiJDlgaXlurfloavmiqUiKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAocmVzWzBdLlBDUiA9PT0gIuWQpiIpIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLmirHmrYnvvIzkvaDlvZPliY3kuI3og73miqXlkI3lv5fmhL/ogIUiKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLiRjb25maXJtKCLmmK/lkKbnoa7orqTmiqXlkI3lv5fmhL/ogIU/IiwgIuaPkOekuiIsIHsNCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIuehruWumiIsDQogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIuWPlua2iCIsDQogICAgICAgICAgdHlwZTogIndhcm5pbmciLA0KICAgICAgICB9KQ0KICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIGdldEVudGVyVm9sdW50ZWVyUmVxdXNldCgpDQogICAgICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuaKpeWQjeaIkOWKnyHor7fnrYnlvoXogIHluIjkuI7kvaDogZTns7siKTsNCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoIuS9oOW3sue7j+WujOaIkOW/l+aEv+iAheaKpeWQje+8jOivt+WLv+mHjeWkjeaPkOS6pCIpOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oIuW3suWPlua2iCIpOw0KICAgICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["volunteer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"volunteer.vue","sourceRoot":"src/components/student","sourcesContent":["<template>\r\n  <div>\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <el-card v-if=\"!isVolun\">\r\n          <div slot=\"header\" class=\"clearfix\" style=\"text-align: center\">\r\n            <span>志愿者报名</span>\r\n          </div>\r\n          <div style=\"text-align: center\">\r\n            <el-button type=\"primary\" @click=\"enterVolun\">报名</el-button>\r\n          </div>\r\n        </el-card>\r\n        <el-card v-else-if=\"isVolun\">\r\n          <el-alert title=\"已报名志愿者\" type=\"success\" center show-icon>\r\n          </el-alert>\r\n          <el-table :data=\"userVolun\" border style=\"width: 100%\">\r\n            <el-table-column prop=\"u_id\" label=\"学号\"> </el-table-column>\r\n            <el-table-column prop=\"u_name\" label=\"姓名\"> </el-table-column>\r\n            <el-table-column prop=\"address\" label=\"分配地点\"> </el-table-column>\r\n            <el-table-column prop=\"group\" label=\"分配小组\"> </el-table-column>\r\n            <el-table-column prop=\"createtime\" label=\"报名时间\">\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n        <el-divider></el-divider>\r\n        <el-card>\r\n          <div slot=\"header\" class=\"clearfix\" style=\"text-align: center\">\r\n            <span>志愿者名单</span>\r\n          </div>\r\n          <el-table\r\n            :data=\"volunteerList\"\r\n            style=\"width: 100%\"\r\n            :default-sort=\"{ prop: 'createtime', order: 'descending' }\"\r\n          >\r\n            <el-table-column\r\n              prop=\"createtime\"\r\n              label=\"报名日期\"\r\n              sortable\r\n              width=\"230\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column prop=\"u_id\" label=\"学号\" sortable width=\"230\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"u_name\" label=\"姓名\" sortable width=\"230\">\r\n            </el-table-column>\r\n            <el-table-column\r\n              prop=\"address\"\r\n              label=\"分配地点\"\r\n              sortable\r\n              width=\"230\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column prop=\"group\" label=\"分配小组\" sortable width=\"230\">\r\n            </el-table-column>\r\n          </el-table>\r\n\r\n          <div class=\"block\" style=\"text-align: center; margin-top: 20px\">\r\n            <el-pagination layout=\"prev, pager, next\" :total=\"50\">\r\n            </el-pagination>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getUserDataByToken,\r\n  getHealthNowDayByidRequest,\r\n  getEnterVolunteerRequset,\r\n  getAllVolunteerRequest,\r\n  getVolunteerByIdRequest,\r\n} from \"@/api/request\";\r\nimport { formatID, formatYear } from '@/api/utils';\r\nexport default {\r\n  name: \"volunteer\",\r\n  data() {\r\n    return {\r\n      userInfo: \"\", //用户个人信息\r\n      volunteerList: [], //所有志愿者列表\r\n      isVolun: false,\r\n      userVolun: [],\r\n    };\r\n  },\r\n  created() {\r\n    getUserDataByToken().then((res) => {\r\n      this.userInfo = res\r\n    });\r\n    getAllVolunteerRequest().then((res) => {\r\n      res.forEach((item) => {\r\n        if (this.userInfo.id === item.u_id) {\r\n          this.$nextTick(function () {\r\n            this.isVolun = true;\r\n          });\r\n        }\r\n      });\r\n      this.volunteerList = res.map((item) => {\r\n        return {\r\n          ...item,\r\n          createtime: formatYear(item.createtime),\r\n          u_id:formatID(item.u_id)\r\n        };\r\n      });\r\n    });\r\n    getVolunteerByIdRequest().then((res) => {\r\n      console.log(res);\r\n      this.userVolun = res.map((item) => {\r\n        return {\r\n          ...item,\r\n          createtime: item.createtime.slice(0, 10),\r\n          u_id:\r\n            String(item.u_id)[0] === 1 ? String(item.u_id) : `0${item.u_id}`,\r\n        };\r\n      });\r\n    });\r\n  },\r\n  methods: {\r\n    //报名志愿者\r\n    enterVolun() {\r\n      getHealthNowDayByidRequest().then((res) => {\r\n        if (!res.length) {\r\n          this.$message.warning(\"你今天还未完成健康填报，请先完成健康填报\");\r\n        }\r\n        if (res[0].PCR === \"否\") {\r\n          this.$message.error(\"抱歉，你当前不能报名志愿者\");\r\n        }\r\n        this.$confirm(\"是否确认报名志愿者?\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        })\r\n          .then(() => {\r\n            getEnterVolunteerRequset()\r\n              .then(() => {\r\n                this.$message.success(\"报名成功!请等待老师与你联系\");\r\n              })\r\n              .catch((err) => {\r\n                this.$message.warning(\"你已经完成志愿者报名，请勿重复提交\");\r\n              });\r\n          })\r\n          .catch(() => {\r\n            this.$message.info(\"已取消\");\r\n          });\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>"]}]}