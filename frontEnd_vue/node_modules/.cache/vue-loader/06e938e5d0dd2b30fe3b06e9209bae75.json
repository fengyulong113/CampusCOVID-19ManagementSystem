{"remainingRequest":"D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\src\\components\\student\\volunteer.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\src\\components\\student\\volunteer.vue","mtime":1649516078577},{"path":"D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637570406894},{"path":"D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1627202897183},{"path":"D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637570406894},{"path":"D:\\fyl_Web\\CampusCOVID-19ManagementSystem\\frontEnd_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1648636261085}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBnZXRVc2VyRGF0YUJ5VG9rZW4sDQogIGdldEhlYWx0aE5vd0RheUJ5aWRSZXF1ZXN0LA0KICBnZXRFbnRlclZvbHVudGVlclJlcXVzZXQsDQogIGdldEFsbFZvbHVudGVlclJlcXVlc3QsDQogIGdldFZvbHVudGVlckJ5SWRSZXF1ZXN0LA0KfSBmcm9tICJAL2FwaS9yZXF1ZXN0IjsNCmltcG9ydCB7IGZvcm1hdElELCBmb3JtYXRZZWFyIH0gZnJvbSAiQC9hcGkvdXRpbHMiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAidm9sdW50ZWVyIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdXNlckluZm86ICIiLCAvL+eUqOaIt+S4quS6uuS/oeaBrw0KICAgICAgdm9sdW50ZWVyTGlzdDogW10sIC8v5omA5pyJ5b+X5oS/6ICF5YiX6KGoDQogICAgICBpc1ZvbHVuOiBmYWxzZSwgLy/lv5fmhL/ogIXmiqXlkI3mmL7npLov6ZqQ6JePDQogICAgICB1c2VyVm9sdW46IFtdLCAvL+W/l+aEv+iAheS/oeaBrw0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgZ2V0VXNlckRhdGFCeVRva2VuKCkudGhlbigocmVzKSA9PiB7DQogICAgICB0aGlzLnVzZXJJbmZvID0gcmVzOw0KICAgIH0pOw0KICAgIGdldEFsbFZvbHVudGVlclJlcXVlc3QoKS50aGVuKChyZXMpID0+IHsNCiAgICAgIHJlcy5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgIGlmICh0aGlzLnVzZXJJbmZvLmlkID09PSBpdGVtLnVfaWQpIHsNCiAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLmlzVm9sdW4gPSB0cnVlOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIHRoaXMudm9sdW50ZWVyTGlzdCA9IHJlcy5tYXAoKGl0ZW0pID0+IHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAuLi5pdGVtLA0KICAgICAgICAgIGNyZWF0ZXRpbWU6IGZvcm1hdFllYXIoaXRlbS5jcmVhdGV0aW1lKSwNCiAgICAgICAgICB1X2lkOiBmb3JtYXRJRChpdGVtLnVfaWQpLA0KICAgICAgICB9Ow0KICAgICAgfSk7DQogICAgfSk7DQogICAgZ2V0Vm9sdW50ZWVyQnlJZFJlcXVlc3QoKS50aGVuKChyZXMpID0+IHsNCiAgICAgIGNvbnNvbGUubG9nKHJlcyk7DQogICAgICB0aGlzLnVzZXJWb2x1biA9IHJlcy5tYXAoKGl0ZW0pID0+IHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAuLi5pdGVtLA0KICAgICAgICAgIGNyZWF0ZXRpbWU6IGZvcm1hdFllYXIoaXRlbS5jcmVhdGV0aW1lKSwNCiAgICAgICAgICB1X2lkOiBmb3JtYXRJRChpdGVtLnVfaWQpLA0KICAgICAgICB9Ow0KICAgICAgfSk7DQogICAgfSk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvL+aKpeWQjeW/l+aEv+iAhQ0KICAgIGVudGVyVm9sdW4oKSB7DQogICAgICBnZXRIZWFsdGhOb3dEYXlCeWlkUmVxdWVzdCgpLnRoZW4oKHJlcykgPT4gew0KICAgICAgICBpZiAoIXJlcy5sZW5ndGgpIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoIuS9oOS7iuWkqei/mOacquWujOaIkOWBpeW6t+Whq+aKpe+8jOivt+WFiOWujOaIkOWBpeW6t+Whq+aKpSIpOw0KICAgICAgICB9DQogICAgICAgIGlmIChyZXNbMF0uUENSID09PSAi5ZCmIikgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuaKseatie+8jOS9oOW9k+WJjeS4jeiDveaKpeWQjeW/l+aEv+iAhSIpOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuJGNvbmZpcm0oIuaYr+WQpuehruiupOaKpeWQjeW/l+aEv+iAhT8iLCAi5o+Q56S6Iiwgew0KICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwNCiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwNCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgIH0pDQogICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgZ2V0RW50ZXJWb2x1bnRlZXJSZXF1c2V0KCkNCiAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5oql5ZCN5oiQ5YqfIeivt+etieW+heiAgeW4iOS4juS9oOiBlOezuyIpOw0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygi5L2g5bey57uP5a6M5oiQ5b+X5oS/6ICF5oql5ZCN77yM6K+35Yu/6YeN5aSN5o+Q5LqkIik7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygi5bey5Y+W5raIIik7DQogICAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["volunteer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"volunteer.vue","sourceRoot":"src/components/student","sourcesContent":["<template>\r\n  <div>\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <el-card v-if=\"!isVolun\">\r\n          <div slot=\"header\" class=\"clearfix\" style=\"text-align: center\">\r\n            <span>志愿者报名</span>\r\n          </div>\r\n          <div style=\"text-align: center\">\r\n            <el-button type=\"primary\" @click=\"enterVolun\">报名</el-button>\r\n          </div>\r\n        </el-card>\r\n        <el-card v-else-if=\"isVolun\">\r\n          <el-alert title=\"已报名志愿者\" type=\"success\" center show-icon>\r\n          </el-alert>\r\n          <el-table :data=\"userVolun\" border style=\"width: 100%\">\r\n            <el-table-column prop=\"u_id\" label=\"学号\"> </el-table-column>\r\n            <el-table-column prop=\"u_name\" label=\"姓名\"> </el-table-column>\r\n            <el-table-column prop=\"address\" label=\"分配地点\"> </el-table-column>\r\n            <el-table-column prop=\"group\" label=\"分配小组\"> </el-table-column>\r\n            <el-table-column prop=\"createtime\" label=\"报名时间\">\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n        <el-divider></el-divider>\r\n        <el-card>\r\n          <div slot=\"header\" class=\"clearfix\" style=\"text-align: center\">\r\n            <span>志愿者名单</span>\r\n          </div>\r\n          <el-table\r\n            :data=\"volunteerList\"\r\n            style=\"width: 100%\"\r\n            :default-sort=\"{ prop: 'createtime', order: 'descending' }\"\r\n          >\r\n            <el-table-column\r\n              prop=\"createtime\"\r\n              label=\"报名日期\"\r\n              sortable\r\n              width=\"230\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column prop=\"u_id\" label=\"学号\" sortable width=\"230\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"u_name\" label=\"姓名\" sortable width=\"230\">\r\n            </el-table-column>\r\n            <el-table-column\r\n              prop=\"address\"\r\n              label=\"分配地点\"\r\n              sortable\r\n              width=\"230\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column prop=\"group\" label=\"分配小组\" sortable width=\"230\">\r\n            </el-table-column>\r\n          </el-table>\r\n\r\n          <div class=\"block\" style=\"text-align: center; margin-top: 20px\">\r\n            <el-pagination layout=\"prev, pager, next\" :total=\"50\">\r\n            </el-pagination>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getUserDataByToken,\r\n  getHealthNowDayByidRequest,\r\n  getEnterVolunteerRequset,\r\n  getAllVolunteerRequest,\r\n  getVolunteerByIdRequest,\r\n} from \"@/api/request\";\r\nimport { formatID, formatYear } from \"@/api/utils\";\r\nexport default {\r\n  name: \"volunteer\",\r\n  data() {\r\n    return {\r\n      userInfo: \"\", //用户个人信息\r\n      volunteerList: [], //所有志愿者列表\r\n      isVolun: false, //志愿者报名显示/隐藏\r\n      userVolun: [], //志愿者信息\r\n    };\r\n  },\r\n  created() {\r\n    getUserDataByToken().then((res) => {\r\n      this.userInfo = res;\r\n    });\r\n    getAllVolunteerRequest().then((res) => {\r\n      res.forEach((item) => {\r\n        if (this.userInfo.id === item.u_id) {\r\n          this.$nextTick(function () {\r\n            this.isVolun = true;\r\n          });\r\n        }\r\n      });\r\n      this.volunteerList = res.map((item) => {\r\n        return {\r\n          ...item,\r\n          createtime: formatYear(item.createtime),\r\n          u_id: formatID(item.u_id),\r\n        };\r\n      });\r\n    });\r\n    getVolunteerByIdRequest().then((res) => {\r\n      console.log(res);\r\n      this.userVolun = res.map((item) => {\r\n        return {\r\n          ...item,\r\n          createtime: formatYear(item.createtime),\r\n          u_id: formatID(item.u_id),\r\n        };\r\n      });\r\n    });\r\n  },\r\n  methods: {\r\n    //报名志愿者\r\n    enterVolun() {\r\n      getHealthNowDayByidRequest().then((res) => {\r\n        if (!res.length) {\r\n          this.$message.warning(\"你今天还未完成健康填报，请先完成健康填报\");\r\n        }\r\n        if (res[0].PCR === \"否\") {\r\n          this.$message.error(\"抱歉，你当前不能报名志愿者\");\r\n        }\r\n        this.$confirm(\"是否确认报名志愿者?\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        })\r\n          .then(() => {\r\n            getEnterVolunteerRequset()\r\n              .then(() => {\r\n                this.$message.success(\"报名成功!请等待老师与你联系\");\r\n              })\r\n              .catch((err) => {\r\n                this.$message.warning(\"你已经完成志愿者报名，请勿重复提交\");\r\n              });\r\n          })\r\n          .catch(() => {\r\n            this.$message.info(\"已取消\");\r\n          });\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>"]}]}